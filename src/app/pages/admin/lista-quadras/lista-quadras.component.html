<div class="container py-4">
  <!-- Navbar -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h2 class="mb-1">Quadras Cadastradas</h2>
      <p class="text-muted mb-0">Gerencie todas as quadras do sistema</p>
    </div>
    <nav>
      <ul class="nav">
        <li class="nav-item">
          <a class="nav-link" (click)="voltarParaHome()" style="cursor: pointer;">
            <i class="bi bi-house me-2"></i>Dashboard Admin
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" style="cursor: pointer;">
            <i class="bi bi-list-ul me-2"></i>Listagem de Quadras
          </a>
        </li>
      </ul>
    </nav>
  </div>

  <button class="btn btn-success mb-3" (click)="irParaCadastro()">
    <i class="bi bi-plus-circle me-2"></i>Cadastrar Nova Quadra
  </button>
  <div *ngIf="loading">Carregando quadras...</div>
  <!-- Modal de Erro -->
  <div class="modal fade show" tabindex="-1" aria-labelledby="modalErroLabel" aria-modal="true" role="dialog" *ngIf="error" style="display: block; background: rgba(0,0,0,0.2);">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header bg-danger text-white">
          <h5 class="modal-title" id="modalErroLabel">
            <i class="bi bi-x-circle me-2"></i>
            Erro ao carregar quadras
          </h5>
          <button type="button" class="btn-close" (click)="error = ''" aria-label="Fechar"></button>
        </div>
        <div class="modal-body text-center">
          <p class="mb-3">{{ error }}</p>
          <button class="btn btn-outline-success" (click)="voltarParaHome()">
            <i class="bi bi-arrow-left me-2"></i>Voltar para Dashboard
          </button>
        </div>
      </div>
    </div>
  </div>
  <table class="table table-striped" *ngIf="!loading && quadras.length">
    <thead>
      <tr>
        <th>ID</th>
        <th>Número</th>
        <th>Modalidade</th>
        <th>Qtd. Pessoas</th>
        <th>Disponível</th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let quadra of quadras">
        <td>{{ quadra.id }}</td>
        <td>{{ quadra.numero }}</td>
        <td>{{ quadra.modalidade }}</td>
        <td>{{ quadra.qtdPessoas }}</td>
        <td>
          <span [class]="quadra.isDisponivel ? 'badge bg-success' : 'badge bg-danger'">
            {{ quadra.isDisponivel ? 'Ativa' : 'Inativa' }}
          </span>
        </td>
        <td>
          <div class="btn-group" role="group">
            <button
              class="btn btn-sm"
              [class.btn-outline-warning]="quadra.isDisponivel"
              [class.btn-outline-success]="!quadra.isDisponivel"
              (click)="abrirModalConfirmacao(quadra)"
              title="{{ quadra.isDisponivel ? 'Marcar como Indisponível' : 'Marcar como Disponível' }}"
            >
              <i class="bi" [class.bi-toggle-on]="quadra.isDisponivel" [class.bi-toggle-off]="!quadra.isDisponivel"></i>
            </button>
            <button
              class="btn btn-edit btn-sm"
              (click)="irParaDetalhes(quadra.id)"
              title="Ver Detalhes"
            >
              <i class="bi bi-eye"></i>
            </button>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
  <!-- Modal de Nenhuma Quadra Cadastrada -->
  <div class="modal fade show" tabindex="-1" aria-labelledby="modalNenhumaQuadraLabel" aria-modal="true" role="dialog" *ngIf="!loading && quadras.length === 0" style="display: block; background: rgba(0,0,0,0.2);">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header bg-warning text-dark">
          <h5 class="modal-title" id="modalNenhumaQuadraLabel">
            <i class="bi bi-exclamation-triangle me-2"></i>
            Nenhuma quadra cadastrada
          </h5>
          <button type="button" class="btn-close" (click)="voltarParaHome()" aria-label="Fechar"></button>
        </div>
        <div class="modal-body text-center">
          <p class="mb-3">Não há quadras cadastradas no sistema.</p>
          <button class="btn btn-success" (click)="irParaCadastro()">
            <i class="bi bi-plus-circle me-2"></i>Cadastrar Nova Quadra
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal de Confirmação de Alteração de Disponibilidade -->
<div class="modal fade" id="modalConfirmacaoDisponibilidade" tabindex="-1" aria-labelledby="modalConfirmacaoDisponibilidadeLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalConfirmacaoDisponibilidadeLabel">Confirmar Alteração</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
      </div>
      <div class="modal-body">
        <p>Tem certeza que deseja alterar o status da quadra?</p>
        <div *ngIf="quadraSelecionada" class="mt-3">
          <strong>Quadra:</strong> {{ quadraSelecionada.numero }} - {{ quadraSelecionada.modalidade }}<br>
          <strong>Status atual:</strong> 
          <span [class]="quadraSelecionada.isDisponivel ? 'badge bg-success' : 'badge bg-danger'">
            {{ quadraSelecionada.isDisponivel ? 'Ativa' : 'Inativa' }}
          </span><br>
          <strong>Novo status:</strong> 
          <span [class]="!quadraSelecionada.isDisponivel ? 'badge bg-success' : 'badge bg-danger'">
            {{ !quadraSelecionada.isDisponivel ? 'Ativa' : 'Inativa' }}
          </span>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-success" data-bs-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-success" (click)="confirmarAlteracaoDisponibilidade()" data-bs-dismiss="modal">
          Confirmar
        </button>
      </div>
    </div>
  </div>
</div>
